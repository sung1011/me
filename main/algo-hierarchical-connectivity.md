# hierarchical connectivity  层次聚类

层次聚类是一种通过计算样本之间的相似度, 逐步合并相似度最高的样本, 构建一棵树的聚类方法

## 原理

```js
                        d
                             e

              b
    a
       c
```

通过计算样本之间的相似度, 逐步合并相似度最高的样本, 构建一棵树

1. a, c 相似度最高, 合并为一个簇
2. d, e 相似度最高, 合并为一个簇
3. b, (a, c) 相似度最高, 合并为一个簇
4. (a, c, b), (d, e) 相似度最高, 合并为一个簇

### 相似度计算

b, (a, c)的相似度计算

- 最短距离法 single : min(d(a, b), d(c, b))
- 最长距离法 complete : max(d(a, b), d(c, b))
- 平均距离法 average : (d(a, b) + d(c, b)) / 2
- 中心距离法 centroid : d(a, b) + d(c, b) - d(a, c)

> d 表达距离

### 树

树结构表达了合并过程, 也可以通过树结构来选择合适的簇

```js
           |            
        -------         <- 分2组
       |       |
      ---      |        <- 分3组
     |   |    ---       <- 分4组
------   |   |   |      <- 分5组
|    |   |   |   |
a    c   b   d   e
```

## 意义

- 通过树状结构展示数据之间的相似度
- 可以通过树状结构来选择合适的簇

## 缺点

- 计算复杂度高
- 无法处理噪声数据

## 实例

- 基因图谱

  通过计算基因之间的相似度, 逐步合并相似度最高的基因, 构建一棵树